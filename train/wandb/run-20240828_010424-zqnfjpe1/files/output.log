  0%|                                                                                                                                                        | 0/45 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  2%|███▏                                                                                                                                            | 1/45 [00:25<18:44, 25.57s/it]

  4%|██████▍                                                                                                                                         | 2/45 [00:45<16:03, 22.40s/it]

  7%|█████████▌                                                                                                                                      | 3/45 [01:05<14:57, 21.37s/it]

  9%|████████████▊                                                                                                                                   | 4/45 [01:25<14:14, 20.85s/it]

 11%|████████████████                                                                                                                                | 5/45 [01:46<13:44, 20.62s/it]

 13%|███████████████████▏                                                                                                                            | 6/45 [02:06<13:18, 20.47s/it]

 16%|██████████████████████▍                                                                                                                         | 7/45 [02:26<12:54, 20.38s/it]

 18%|███████████████████████████▋                                                                                                                                | 8/45 [02:46<12:31, 20.31s/it]

 20%|███████████████████████████████▏                                                                                                                            | 9/45 [03:06<12:09, 20.27s/it]

 22%|██████████████████████████████████▍                                                                                                                        | 10/45 [03:26<11:47, 20.22s/it]

 24%|█████████████████████████████████████▉                                                                                                                     | 11/45 [03:47<11:27, 20.21s/it]

 27%|█████████████████████████████████████████▎                                                                                                                 | 12/45 [04:07<11:06, 20.20s/it]

 29%|████████████████████████████████████████████▊                                                                                                              | 13/45 [04:27<10:44, 20.14s/it]

 31%|████████████████████████████████████████████████▏                                                                                                          | 14/45 [04:47<10:24, 20.16s/it]

 33%|███████████████████████████████████████████████████▋                                                                                                       | 15/45 [05:07<10:04, 20.16s/it]
{'loss': 0.4719, 'grad_norm': 1.194398617912663, 'learning_rate': 6.666666666666667e-06, 'epoch': 4.21}

 36%|███████████████████████████████████████████████████████                                                                                                    | 16/45 [05:27<09:44, 20.16s/it]


 40%|██████████████████████████████████████████████████████████████                                                                                             | 18/45 [06:08<09:03, 20.15s/it]

 42%|█████████████████████████████████████████████████████████████████▍                                                                                         | 19/45 [06:28<08:44, 20.16s/it]

 44%|████████████████████████████████████████████████████████████████████▉                                                                                      | 20/45 [06:48<08:23, 20.14s/it]

 47%|████████████████████████████████████████████████████████████████████████▎                                                                                  | 21/45 [07:08<08:02, 20.12s/it]

 49%|███████████████████████████████████████████████████████████████████████████▊                                                                               | 22/45 [07:28<07:42, 20.11s/it]

 51%|███████████████████████████████████████████████████████████████████████████████▏                                                                           | 23/45 [07:48<07:22, 20.13s/it]

 53%|██████████████████████████████████████████████████████████████████████████████████▋                                                                        | 24/45 [08:08<07:03, 20.14s/it]

 56%|██████████████████████████████████████████████████████████████████████████████████████                                                                     | 25/45 [08:29<06:43, 20.16s/it]

 58%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                 | 26/45 [08:49<06:23, 20.18s/it]

 60%|█████████████████████████████████████████████████████████████████████████████████████████████                                                              | 27/45 [09:12<06:19, 21.07s/it]

 62%|████████████████████████████████████████████████████████████████████████████████████████████████▍                                                          | 28/45 [09:54<07:44, 27.30s/it]

 64%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                       | 29/45 [10:16<06:51, 25.70s/it]

 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                   | 30/45 [11:34<10:23, 41.57s/it]

 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                | 31/45 [12:23<10:11, 43.71s/it]

 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                            | 32/45 [13:49<12:12, 56.32s/it]
{'loss': 0.1298, 'grad_norm': 0.8889256041778923, 'learning_rate': 2.888888888888889e-06, 'epoch': 8.98}


 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 34/45 [15:55<11:16, 61.46s/it]

 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 35/45 [17:13<11:02, 66.25s/it]

 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                               | 36/45 [17:57<08:57, 59.70s/it]

 82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                           | 37/45 [19:21<08:55, 66.88s/it]

 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                        | 38/45 [20:29<07:50, 67.22s/it]

 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 39/45 [21:23<06:19, 63.30s/it]

 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 40/45 [22:52<05:54, 70.94s/it]

 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏             | 41/45 [23:53<04:32, 68.13s/it]

 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 42/45 [24:58<03:21, 67.13s/it]

 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 43/45 [26:33<02:31, 75.52s/it]

 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 44/45 [27:21<01:07, 67.13s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [28:44<00:00, 71.99s/it][INFO|trainer.py:2383] 2024-08-28 01:33:15,904 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [28:44<00:00, 38.32s/it]
{'loss': 0.0633, 'grad_norm': 0.44739354066035575, 'learning_rate': 0.0, 'epoch': 12.63}
{'train_runtime': 1733.5583, 'train_samples_per_second': 7.787, 'train_steps_per_second': 0.026, 'train_loss': 0.38616066856516734, 'epoch': 12.63}
[INFO|trainer.py:3478] 2024-08-28 01:33:27,200 >> Saving model checkpoint to /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05
[INFO|configuration_utils.py:472] 2024-08-28 01:33:27,208 >> Configuration saved in /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05/config.json
[INFO|configuration_utils.py:769] 2024-08-28 01:33:27,209 >> Configuration saved in /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05/generation_config.json
[INFO|modeling_utils.py:2698] 2024-08-28 01:33:47,487 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 3 checkpoint shards. You can find where each parameters has been saved in the index located at /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2574] 2024-08-28 01:33:47,488 >> tokenizer config file saved in /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05/tokenizer_config.json
[INFO|tokenization_utils_base.py:2583] 2024-08-28 01:33:47,489 >> Special tokens file saved in /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05/special_tokens_map.json
[INFO|trainer.py:3788] 2024-08-28 01:33:48,248 >>
***** Running Evaluation *****
[INFO|trainer.py:3790] 2024-08-28 01:33:48,248 >>   Num examples = 100
[INFO|trainer.py:3793] 2024-08-28 01:33:48,248 >>   Batch size = 1
***** train metrics *****
  epoch                    =    12.6316
  total_flos               =     5191GF
  train_loss               =     0.3862
  train_runtime            = 0:28:53.55
  train_samples_per_second =      7.787
  train_steps_per_second   =      0.026
Figure saved at: /model/output/llama2-7b-cluster_pair_score_myprompt_sharegpt_refined-e15lr1e-05/training_loss.png
08/28/2024 01:33:48 - WARNING - llamafactory.extras.ploting - No metric eval_loss to plot.









 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 12/13 [00:22<00:02,  2.15s/it]
***** eval metrics *****
  epoch                   =    12.6316
  eval_loss               =     1.5597
  eval_runtime            = 0:00:27.53
  eval_samples_per_second =      3.632
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:24<00:00,  1.92s/it]
[INFO|modelcard.py:449] 2024-08-28 01:34:15,785 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
  0%|                                                                                                                                                             | 0/105 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  1%|█▍                                                                                                                                                   | 1/105 [00:31<54:47, 31.61s/it]

  2%|██▊                                                                                                                                                  | 2/105 [00:57<48:48, 28.43s/it]
{'loss': 6.7712, 'grad_norm': 226.09570878557162, 'learning_rate': 1.9619047619047617e-06, 'epoch': 0.28}

  3%|████▎                                                                                                                                                | 3/105 [01:23<46:17, 27.23s/it]


  5%|███████                                                                                                                                              | 5/105 [02:13<43:13, 25.93s/it]
{'loss': 5.7836, 'grad_norm': 140.15019844795083, 'learning_rate': 1.9047619047619045e-06, 'epoch': 0.71}


  7%|█████████▉                                                                                                                                           | 7/105 [03:03<41:30, 25.42s/it]
{'loss': 5.4795, 'grad_norm': 158.13690049091957, 'learning_rate': 1.8666666666666667e-06, 'epoch': 0.99}


  9%|████████████▊                                                                                                                                        | 9/105 [03:53<40:15, 25.16s/it]

 10%|██████████████                                                                                                                                      | 10/105 [04:18<39:42, 25.08s/it]

 10%|███████████████▌                                                                                                                                    | 11/105 [04:43<39:12, 25.02s/it]

 11%|████████████████▉                                                                                                                                   | 12/105 [05:08<38:38, 24.93s/it]
{'loss': 4.6155, 'grad_norm': 106.55287254897213, 'learning_rate': 1.7714285714285712e-06, 'epoch': 1.7}


 13%|███████████████████▋                                                                                                                                | 14/105 [05:58<37:53, 24.98s/it]

 14%|█████████████████████▏                                                                                                                              | 15/105 [06:23<37:30, 25.01s/it]

 15%|██████████████████████▌                                                                                                                             | 16/105 [06:48<37:04, 24.99s/it]

 16%|███████████████████████▉                                                                                                                            | 17/105 [07:13<36:30, 24.89s/it]

 17%|█████████████████████████▎                                                                                                                          | 18/105 [07:37<35:57, 24.80s/it]

 18%|██████████████████████████▊                                                                                                                         | 19/105 [08:02<35:32, 24.79s/it]
{'loss': 3.7685, 'grad_norm': 100.37847324314612, 'learning_rate': 1.638095238095238e-06, 'epoch': 2.69}


 20%|█████████████████████████████▌                                                                                                                      | 21/105 [08:52<34:49, 24.87s/it]

 21%|███████████████████████████████                                                                                                                     | 22/105 [09:16<34:19, 24.81s/it]

 22%|████████████████████████████████▍                                                                                                                   | 23/105 [09:41<33:57, 24.85s/it]

 23%|█████████████████████████████████▊                                                                                                                  | 24/105 [10:06<33:30, 24.83s/it]

 24%|███████████████████████████████████▏                                                                                                                | 25/105 [10:31<33:01, 24.76s/it]

 25%|████████████████████████████████████▋                                                                                                               | 26/105 [10:56<32:40, 24.82s/it]

 26%|██████████████████████████████████████                                                                                                              | 27/105 [11:21<32:15, 24.82s/it]

 27%|███████████████████████████████████████▍                                                                                                            | 28/105 [11:45<31:52, 24.84s/it]

 28%|████████████████████████████████████████▉                                                                                                           | 29/105 [12:11<31:34, 24.93s/it]
{'loss': 3.1766, 'grad_norm': 87.24143157246161, 'learning_rate': 1.4476190476190475e-06, 'epoch': 4.11}


 30%|███████████████████████████████████████████▋                                                                                                        | 31/105 [13:00<30:38, 24.84s/it]

 30%|█████████████████████████████████████████████                                                                                                       | 32/105 [13:25<30:06, 24.75s/it]
{'loss': 2.9515, 'grad_norm': 96.00245154747351, 'learning_rate': 1.3904761904761904e-06, 'epoch': 4.53}


 32%|███████████████████████████████████████████████▉                                                                                                    | 34/105 [14:14<29:22, 24.83s/it]
{'loss': 2.6911, 'grad_norm': 76.50951291444908, 'learning_rate': 1.3523809523809523e-06, 'epoch': 4.81}


 34%|██████████████████████████████████████████████████▋                                                                                                 | 36/105 [15:04<28:36, 24.88s/it]

 35%|████████████████████████████████████████████████████▏                                                                                               | 37/105 [15:29<28:09, 24.85s/it]
{'loss': 2.8963, 'grad_norm': 90.97797102011837, 'learning_rate': 1.2952380952380952e-06, 'epoch': 5.24}


 37%|██████████████████████████████████████████████████████▉                                                                                             | 39/105 [16:19<27:19, 24.85s/it]
{'loss': 3.1149, 'grad_norm': 75.85363488839049, 'learning_rate': 1.2571428571428571e-06, 'epoch': 5.52}


 39%|█████████████████████████████████████████████████████████▊                                                                                          | 41/105 [17:08<26:30, 24.85s/it]

 40%|███████████████████████████████████████████████████████████▏                                                                                        | 42/105 [17:33<26:05, 24.85s/it]

 41%|████████████████████████████████████████████████████████████▌                                                                                       | 43/105 [17:58<25:45, 24.92s/it]
{'loss': 2.69, 'grad_norm': 69.89415826358452, 'learning_rate': 1.1809523809523808e-06, 'epoch': 6.09}


 43%|███████████████████████████████████████████████████████████████▍                                                                                    | 45/105 [18:48<24:55, 24.92s/it]

 44%|████████████████████████████████████████████████████████████████▊                                                                                   | 46/105 [19:13<24:29, 24.90s/it]
{'loss': 2.6241, 'grad_norm': 82.63469414102802, 'learning_rate': 1.1238095238095239e-06, 'epoch': 6.51}


 46%|███████████████████████████████████████████████████████████████████▋                                                                                | 48/105 [20:02<23:29, 24.72s/it]

 47%|█████████████████████████████████████████████████████████████████████                                                                               | 49/105 [20:27<23:07, 24.78s/it]
{'loss': 2.676, 'grad_norm': 71.43542552215428, 'learning_rate': 1.0666666666666667e-06, 'epoch': 6.94}


 49%|███████████████████████████████████████████████████████████████████████▉                                                                            | 51/105 [21:16<22:15, 24.73s/it]

 50%|█████████████████████████████████████████████████████████████████████████▎                                                                          | 52/105 [21:41<21:52, 24.76s/it]
{'loss': 2.5515, 'grad_norm': 68.22544916717295, 'learning_rate': 1.0095238095238095e-06, 'epoch': 7.36}


 51%|████████████████████████████████████████████████████████████████████████████                                                                        | 54/105 [22:31<21:03, 24.77s/it]

 52%|█████████████████████████████████████████████████████████████████████████████▌                                                                      | 55/105 [22:56<20:40, 24.82s/it]

 53%|██████████████████████████████████████████████████████████████████████████████▉                                                                     | 56/105 [23:20<20:16, 24.82s/it]

 54%|████████████████████████████████████████████████████████████████████████████████▎                                                                   | 57/105 [23:45<19:48, 24.75s/it]

 55%|█████████████████████████████████████████████████████████████████████████████████▊                                                                  | 58/105 [24:09<19:17, 24.63s/it]
{'loss': 2.3681, 'grad_norm': 73.0380358956893, 'learning_rate': 8.952380952380953e-07, 'epoch': 8.21}


 57%|████████████████████████████████████████████████████████████████████████████████████▌                                                               | 60/105 [24:59<18:29, 24.65s/it]

 58%|█████████████████████████████████████████████████████████████████████████████████████▉                                                              | 61/105 [25:23<18:03, 24.63s/it]

 59%|███████████████████████████████████████████████████████████████████████████████████████▍                                                            | 62/105 [25:48<17:37, 24.59s/it]

 60%|████████████████████████████████████████████████████████████████████████████████████████▊                                                           | 63/105 [26:12<17:12, 24.59s/it]

 61%|██████████████████████████████████████████████████████████████████████████████████████████▏                                                         | 64/105 [26:37<16:53, 24.72s/it]
{'loss': 2.0749, 'grad_norm': 68.33155683983975, 'learning_rate': 7.809523809523809e-07, 'epoch': 9.06}


 63%|█████████████████████████████████████████████████████████████████████████████████████████████                                                       | 66/105 [27:27<16:06, 24.77s/it]

 64%|██████████████████████████████████████████████████████████████████████████████████████████████▍                                                     | 67/105 [27:52<15:40, 24.74s/it]

 65%|███████████████████████████████████████████████████████████████████████████████████████████████▊                                                    | 68/105 [28:16<15:15, 24.75s/it]

 66%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 69/105 [28:41<14:52, 24.80s/it]
{'loss': 2.19, 'grad_norm': 65.6260416583996, 'learning_rate': 6.857142857142857e-07, 'epoch': 9.77}


 68%|████████████████████████████████████████████████████████████████████████████████████████████████████                                                | 71/105 [29:31<14:00, 24.72s/it]

 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                              | 72/105 [29:55<13:34, 24.67s/it]

 70%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                             | 73/105 [30:20<13:08, 24.64s/it]

 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 74/105 [30:45<12:46, 24.73s/it]

 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                          | 75/105 [31:09<12:18, 24.61s/it]

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 76/105 [31:34<11:54, 24.63s/it]

 73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                       | 77/105 [31:59<11:31, 24.71s/it]

 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 78/105 [32:23<11:06, 24.70s/it]

 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                    | 79/105 [32:48<10:43, 24.74s/it]
{'loss': 1.9947, 'grad_norm': 92.26835437326278, 'learning_rate': 4.952380952380952e-07, 'epoch': 11.19}


 77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 81/105 [33:37<09:51, 24.64s/it]

 78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 82/105 [34:02<09:26, 24.64s/it]

 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 83/105 [34:26<09:01, 24.63s/it]

 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 84/105 [34:51<08:37, 24.63s/it]

 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            | 85/105 [35:16<08:14, 24.73s/it]
{'loss': 1.7063, 'grad_norm': 65.83490611583835, 'learning_rate': 3.809523809523809e-07, 'epoch': 12.04}


 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 87/105 [36:05<07:22, 24.56s/it]

 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                        | 88/105 [36:29<06:57, 24.54s/it]

 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 89/105 [36:54<06:32, 24.51s/it]

 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     | 90/105 [37:18<06:07, 24.47s/it]

 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                   | 91/105 [37:42<05:42, 24.45s/it]
{'loss': 1.7508, 'grad_norm': 77.23202157298486, 'learning_rate': 2.6666666666666667e-07, 'epoch': 12.88}


 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                 | 93/105 [38:31<04:53, 24.47s/it]

 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               | 94/105 [38:56<04:28, 24.42s/it]

 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉              | 95/105 [39:20<04:03, 24.39s/it]
{'loss': 1.8642, 'grad_norm': 65.53680084978973, 'learning_rate': 1.9047619047619045e-07, 'epoch': 13.45}


 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 97/105 [40:09<03:15, 24.46s/it]

 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 98/105 [40:34<02:51, 24.51s/it]

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 99/105 [40:58<02:26, 24.44s/it]

 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 100/105 [41:22<02:01, 24.31s/it]

 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 101/105 [41:47<01:37, 24.41s/it]

 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 102/105 [42:11<01:12, 24.31s/it]

 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 103/105 [42:35<00:48, 24.34s/it]

 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 104/105 [42:59<00:24, 24.31s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [43:24<00:00, 24.35s/it][INFO|trainer.py:2383] 2024-08-26 07:56:24,094 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [43:24<00:00, 24.80s/it]
{'loss': 1.7461, 'grad_norm': 59.30078420908529, 'learning_rate': 0.0, 'epoch': 14.87}
{'train_runtime': 2612.4905, 'train_samples_per_second': 5.167, 'train_steps_per_second': 0.04, 'train_loss': 2.8712619690668015, 'epoch': 14.87}
[INFO|trainer.py:3478] 2024-08-26 07:56:31,683 >> Saving model checkpoint to /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus
[INFO|configuration_utils.py:472] 2024-08-26 07:56:31,686 >> Configuration saved in /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus/config.json
[INFO|configuration_utils.py:769] 2024-08-26 07:56:31,687 >> Configuration saved in /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus/generation_config.json
[INFO|modeling_utils.py:2698] 2024-08-26 07:56:45,859 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 3 checkpoint shards. You can find where each parameters has been saved in the index located at /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2574] 2024-08-26 07:56:45,860 >> tokenizer config file saved in /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus/tokenizer_config.json
[INFO|tokenization_utils_base.py:2583] 2024-08-26 07:56:45,860 >> Special tokens file saved in /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus/special_tokens_map.json
[INFO|trainer.py:3788] 2024-08-26 07:56:46,620 >>
***** Running Evaluation *****
[INFO|trainer.py:3790] 2024-08-26 07:56:46,620 >>   Num examples = 100
[INFO|trainer.py:3793] 2024-08-26 07:56:46,620 >>   Batch size = 1
  0%|                                                                                                                                                              | 0/25 [00:00<?, ?it/s]
***** train metrics *****
  epoch                    =    14.8673
  total_flos               =     3263GF
  train_loss               =     2.8713
  train_runtime            = 0:43:32.49
  train_samples_per_second =      5.167
  train_steps_per_second   =       0.04
Figure saved at: /model/output/mistral-7b-cluster_pair_score_myprompt_sharegpt-e15lr2e-06-4gpus/training_loss.png




100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.82it/s]
[INFO|modelcard.py:449] 2024-08-26 07:56:55,906 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =    14.8673
  eval_loss               =     1.0714
  eval_runtime            = 0:00:09.28
  eval_samples_per_second =      10.77
  eval_steps_per_second   =      2.692
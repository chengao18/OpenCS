  0%|                                                                             | 0/135 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  1%|▍                                                                  | 1/135 [00:29<1:05:14, 29.21s/it]

  1%|█                                                                    | 2/135 [00:53<58:51, 26.55s/it]

  2%|█▌                                                                   | 3/135 [01:17<55:33, 25.26s/it]

  3%|██                                                                   | 4/135 [01:43<55:53, 25.60s/it]
{'loss': 1.5714, 'grad_norm': 20.36310403301459, 'learning_rate': 1.951219512195122e-06, 'epoch': 0.09}

  4%|██▌                                                                  | 5/135 [02:06<53:36, 24.74s/it]


  5%|███▌                                                                 | 7/135 [02:56<52:30, 24.62s/it]

  6%|████                                                                 | 8/135 [03:21<52:13, 24.67s/it]

  7%|████▌                                                                | 9/135 [03:44<50:38, 24.12s/it]

  7%|█████                                                               | 10/135 [04:07<49:52, 23.94s/it]

  8%|█████▌                                                              | 11/135 [04:33<50:36, 24.49s/it]

  9%|██████                                                              | 12/135 [04:56<49:17, 24.04s/it]
{'loss': 1.4306, 'grad_norm': 6.738857821799748, 'learning_rate': 5.853658536585366e-06, 'epoch': 0.26}


 10%|███████                                                             | 14/135 [05:42<47:42, 23.66s/it]

 11%|███████▌                                                            | 15/135 [06:05<46:57, 23.48s/it]

 12%|████████                                                            | 16/135 [06:28<46:12, 23.29s/it]

 13%|████████▌                                                           | 17/135 [06:53<46:31, 23.65s/it]

 13%|█████████                                                           | 18/135 [07:16<45:57, 23.57s/it]

 14%|█████████▌                                                          | 19/135 [07:40<45:43, 23.65s/it]

 15%|██████████                                                          | 20/135 [08:03<44:59, 23.47s/it]

 16%|██████████▌                                                         | 21/135 [08:26<44:14, 23.28s/it]

 16%|███████████                                                         | 22/135 [08:50<44:02, 23.39s/it]

 17%|███████████▌                                                        | 23/135 [09:13<43:24, 23.25s/it]

 18%|████████████                                                        | 24/135 [09:35<42:50, 23.16s/it]

 19%|████████████▌                                                       | 25/135 [09:59<42:47, 23.35s/it]

 19%|█████████████                                                       | 26/135 [10:22<42:17, 23.28s/it]

 20%|█████████████▌                                                      | 27/135 [10:46<41:55, 23.29s/it]

 21%|██████████████                                                      | 28/135 [11:09<41:26, 23.24s/it]

 21%|██████████████▌                                                     | 29/135 [11:32<41:00, 23.22s/it]

 22%|███████████████                                                     | 30/135 [11:56<41:07, 23.50s/it]

 23%|███████████████▌                                                    | 31/135 [12:19<40:39, 23.46s/it]

 24%|████████████████                                                    | 32/135 [12:43<40:10, 23.40s/it]

 24%|████████████████▌                                                   | 33/135 [13:05<39:23, 23.17s/it]

 25%|█████████████████▏                                                  | 34/135 [13:29<39:07, 23.24s/it]

 26%|█████████████████▋                                                  | 35/135 [13:53<39:23, 23.64s/it]

 27%|██████████████████▏                                                 | 36/135 [14:17<39:13, 23.78s/it]

 27%|██████████████████▋                                                 | 37/135 [14:42<39:14, 24.03s/it]

 28%|███████████████████▏                                                | 38/135 [15:06<38:58, 24.11s/it]

 29%|███████████████████▋                                                | 39/135 [15:29<38:05, 23.81s/it]

 30%|████████████████████▏                                               | 40/135 [15:53<37:31, 23.70s/it]

 30%|████████████████████▋                                               | 41/135 [16:17<37:19, 23.82s/it]

 31%|█████████████████████▏                                              | 42/135 [16:42<37:13, 24.02s/it]

 32%|█████████████████████▋                                              | 43/135 [17:05<36:25, 23.75s/it]

 33%|██████████████████████▏                                             | 44/135 [17:27<35:35, 23.47s/it]

 33%|██████████████████████▋                                             | 45/135 [17:52<35:28, 23.64s/it]

 34%|███████████████████████▏                                            | 46/135 [18:15<35:01, 23.62s/it]

 35%|███████████████████████▋                                            | 47/135 [18:38<34:19, 23.41s/it]

 36%|████████████████████████▏                                           | 48/135 [19:01<33:58, 23.43s/it]

 36%|████████████████████████▋                                           | 49/135 [19:25<33:29, 23.37s/it]

 37%|█████████████████████████▏                                          | 50/135 [19:48<32:58, 23.28s/it]

 38%|█████████████████████████▋                                          | 51/135 [20:11<32:47, 23.42s/it]

 39%|██████████████████████████▏                                         | 52/135 [20:35<32:24, 23.43s/it]

 39%|██████████████████████████▋                                         | 53/135 [20:59<32:24, 23.71s/it]

 40%|███████████████████████████▏                                        | 54/135 [21:23<31:48, 23.56s/it]

 41%|███████████████████████████▋                                        | 55/135 [21:45<31:07, 23.34s/it]

 41%|████████████████████████████▏                                       | 56/135 [22:10<31:06, 23.63s/it]

 42%|████████████████████████████▋                                       | 57/135 [22:35<31:26, 24.19s/it]

 43%|█████████████████████████████▏                                      | 58/135 [22:58<30:40, 23.91s/it]

 44%|█████████████████████████████▋                                      | 59/135 [23:22<30:14, 23.87s/it]

 44%|██████████████████████████████▏                                     | 60/135 [23:46<29:47, 23.83s/it]

 45%|██████████████████████████████▋                                     | 61/135 [24:10<29:31, 23.94s/it]

 46%|███████████████████████████████▏                                    | 62/135 [24:34<29:07, 23.94s/it]

 47%|███████████████████████████████▋                                    | 63/135 [24:58<28:39, 23.88s/it]

 47%|████████████████████████████████▏                                   | 64/135 [25:21<27:52, 23.55s/it]

 48%|████████████████████████████████▋                                   | 65/135 [25:46<28:06, 24.10s/it]

 49%|█████████████████████████████████▏                                  | 66/135 [26:10<27:31, 23.93s/it]

 50%|█████████████████████████████████▋                                  | 67/135 [26:33<27:04, 23.89s/it]

 50%|██████████████████████████████████▎                                 | 68/135 [26:57<26:44, 23.95s/it]

 51%|██████████████████████████████████▊                                 | 69/135 [27:21<26:09, 23.78s/it]

 52%|███████████████████████████████████▎                                | 70/135 [27:44<25:29, 23.53s/it]

 53%|███████████████████████████████████▊                                | 71/135 [28:08<25:10, 23.61s/it]

 53%|████████████████████████████████████▎                               | 72/135 [28:31<24:49, 23.64s/it]

 54%|████████████████████████████████████▊                               | 73/135 [28:54<24:18, 23.52s/it]

 55%|█████████████████████████████████████▎                              | 74/135 [29:18<23:45, 23.38s/it]

 56%|█████████████████████████████████████▊                              | 75/135 [29:41<23:20, 23.34s/it]

 56%|██████████████████████████████████████▎                             | 76/135 [30:03<22:44, 23.14s/it]

 57%|██████████████████████████████████████▊                             | 77/135 [30:26<22:20, 23.11s/it]

 58%|███████████████████████████████████████▎                            | 78/135 [30:51<22:14, 23.42s/it]

 59%|███████████████████████████████████████▊                            | 79/135 [31:15<22:11, 23.77s/it]

 59%|████████████████████████████████████████▎                           | 80/135 [31:39<21:47, 23.78s/it]

 60%|████████████████████████████████████████▊                           | 81/135 [32:03<21:25, 23.81s/it]

 61%|█████████████████████████████████████████▎                          | 82/135 [32:26<20:55, 23.69s/it]

 61%|█████████████████████████████████████████▊                          | 83/135 [32:50<20:37, 23.80s/it]

 62%|██████████████████████████████████████████▎                         | 84/135 [33:14<20:06, 23.66s/it]

 63%|██████████████████████████████████████████▊                         | 85/135 [33:37<19:38, 23.57s/it]

 64%|███████████████████████████████████████████▎                        | 86/135 [34:02<19:30, 23.88s/it]

 64%|███████████████████████████████████████████▊                        | 87/135 [34:24<18:50, 23.55s/it]

 65%|████████████████████████████████████████████▎                       | 88/135 [34:48<18:31, 23.64s/it]

 66%|████████████████████████████████████████████▊                       | 89/135 [35:12<18:12, 23.75s/it]

 67%|█████████████████████████████████████████████▎                      | 90/135 [35:36<17:42, 23.61s/it]

 67%|█████████████████████████████████████████████▊                      | 91/135 [36:00<17:29, 23.86s/it]

 68%|██████████████████████████████████████████████▎                     | 92/135 [36:23<16:49, 23.48s/it]

 69%|██████████████████████████████████████████████▊                     | 93/135 [36:47<16:34, 23.68s/it]

 70%|███████████████████████████████████████████████▎                    | 94/135 [37:10<16:07, 23.60s/it]

 70%|███████████████████████████████████████████████▊                    | 95/135 [37:33<15:36, 23.41s/it]

 71%|████████████████████████████████████████████████▎                   | 96/135 [37:56<15:04, 23.20s/it]

 72%|████████████████████████████████████████████████▊                   | 97/135 [38:19<14:43, 23.26s/it]

 73%|█████████████████████████████████████████████████▎                  | 98/135 [38:43<14:27, 23.44s/it]

 73%|█████████████████████████████████████████████████▊                  | 99/135 [39:06<13:59, 23.32s/it]

 74%|█████████████████████████████████████████████████▋                 | 100/135 [39:31<13:57, 23.92s/it]

 75%|██████████████████████████████████████████████████▏                | 101/135 [39:56<13:43, 24.21s/it]

 76%|██████████████████████████████████████████████████▌                | 102/135 [40:19<13:06, 23.85s/it]

 76%|███████████████████████████████████████████████████                | 103/135 [40:43<12:38, 23.69s/it]

 77%|███████████████████████████████████████████████████▌               | 104/135 [41:06<12:06, 23.43s/it]

 78%|████████████████████████████████████████████████████               | 105/135 [41:30<11:54, 23.80s/it]

 79%|████████████████████████████████████████████████████▌              | 106/135 [41:54<11:26, 23.68s/it]

 79%|█████████████████████████████████████████████████████              | 107/135 [42:16<10:55, 23.41s/it]

 80%|█████████████████████████████████████████████████████▌             | 108/135 [42:40<10:34, 23.49s/it]

 81%|██████████████████████████████████████████████████████             | 109/135 [43:03<10:03, 23.20s/it]

 81%|██████████████████████████████████████████████████████▌            | 110/135 [43:27<09:51, 23.65s/it]

 82%|███████████████████████████████████████████████████████            | 111/135 [43:50<09:24, 23.51s/it]

 83%|███████████████████████████████████████████████████████▌           | 112/135 [44:13<08:54, 23.25s/it]

 84%|████████████████████████████████████████████████████████           | 113/135 [44:37<08:33, 23.35s/it]

 84%|████████████████████████████████████████████████████████▌          | 114/135 [45:03<08:28, 24.23s/it]

 85%|█████████████████████████████████████████████████████████          | 115/135 [45:33<08:37, 25.86s/it]

 86%|█████████████████████████████████████████████████████████▌         | 116/135 [45:58<08:06, 25.63s/it]

 87%|██████████████████████████████████████████████████████████         | 117/135 [46:21<07:31, 25.08s/it]

 87%|██████████████████████████████████████████████████████████▌        | 118/135 [46:45<07:00, 24.75s/it]

 88%|███████████████████████████████████████████████████████████        | 119/135 [47:08<06:26, 24.17s/it]

 89%|███████████████████████████████████████████████████████████▌       | 120/135 [47:33<06:03, 24.20s/it]

 90%|████████████████████████████████████████████████████████████       | 121/135 [47:58<05:45, 24.65s/it]

 90%|████████████████████████████████████████████████████████████▌      | 122/135 [48:22<05:15, 24.28s/it]

 91%|█████████████████████████████████████████████████████████████      | 123/135 [48:45<04:49, 24.13s/it]

 92%|█████████████████████████████████████████████████████████████▌     | 124/135 [49:08<04:20, 23.69s/it]

 93%|██████████████████████████████████████████████████████████████     | 125/135 [49:31<03:55, 23.59s/it]

 93%|██████████████████████████████████████████████████████████████▌    | 126/135 [49:55<03:32, 23.61s/it]

 94%|███████████████████████████████████████████████████████████████    | 127/135 [50:18<03:06, 23.37s/it]

 95%|███████████████████████████████████████████████████████████████▌   | 128/135 [50:41<02:42, 23.19s/it]

 96%|████████████████████████████████████████████████████████████████   | 129/135 [51:05<02:21, 23.57s/it]

 96%|████████████████████████████████████████████████████████████████▌  | 130/135 [51:28<01:56, 23.40s/it]

 97%|█████████████████████████████████████████████████████████████████  | 131/135 [51:53<01:34, 23.75s/it]

 98%|█████████████████████████████████████████████████████████████████▌ | 132/135 [52:16<01:10, 23.55s/it]

 99%|██████████████████████████████████████████████████████████████████ | 133/135 [52:39<00:46, 23.48s/it]

 99%|██████████████████████████████████████████████████████████████████▌| 134/135 [53:02<00:23, 23.35s/it]
100%|███████████████████████████████████████████████████████████████████| 135/135 [53:26<00:00, 23.60s/it][INFO|trainer.py:2383] 2024-08-22 08:09:03,871 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
100%|███████████████████████████████████████████████████████████████████| 135/135 [53:26<00:00, 23.75s/it]
{'loss': 0.3367, 'grad_norm': 3.5889041239595856, 'learning_rate': 0.0, 'epoch': 2.95}
{'train_runtime': 3214.8893, 'train_samples_per_second': 43.672, 'train_steps_per_second': 0.042, 'train_loss': 0.9325044731299083, 'epoch': 2.95}
[INFO|trainer.py:3478] 2024-08-22 08:09:11,778 >> Saving model checkpoint to /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05
[INFO|configuration_utils.py:472] 2024-08-22 08:09:11,781 >> Configuration saved in /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05/config.json
[INFO|configuration_utils.py:769] 2024-08-22 08:09:11,782 >> Configuration saved in /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05/generation_config.json
[INFO|modeling_utils.py:2698] 2024-08-22 08:09:26,689 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 3 checkpoint shards. You can find where each parameters has been saved in the index located at /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2574] 2024-08-22 08:09:26,690 >> tokenizer config file saved in /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05/tokenizer_config.json
[INFO|tokenization_utils_base.py:2583] 2024-08-22 08:09:26,691 >> Special tokens file saved in /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05/special_tokens_map.json
[INFO|trainer.py:3788] 2024-08-22 08:09:27,436 >>
***** Running Evaluation *****
[INFO|trainer.py:3790] 2024-08-22 08:09:27,437 >>   Num examples = 5200
[INFO|trainer.py:3793] 2024-08-22 08:09:27,437 >>   Batch size = 4
***** train metrics *****
  epoch                    =     2.9508
  total_flos               =    43608GF
  train_loss               =     0.9325
  train_runtime            = 0:53:34.88
  train_samples_per_second =     43.672
  train_steps_per_second   =      0.042
Figure saved at: /model/output/mistral-7b-fastchat_alpaca_52k_beautified-e3lr2e-05/training_loss.png
08/22/2024 08:09:27 - WARNING - llamafactory.extras.ploting - No metric eval_loss to plot.

























100%|███████████████████████████████████████████████████████████████████| 163/163 [00:52<00:00,  3.08it/s]
[INFO|modelcard.py:449] 2024-08-22 08:10:20,812 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =     2.9508
  eval_loss               =     1.8034
  eval_runtime            = 0:00:53.37
  eval_samples_per_second =     97.425
  eval_steps_per_second   =      3.054